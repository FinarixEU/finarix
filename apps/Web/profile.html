<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>Profil – Finarix</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{font-family:system-ui,Arial;margin:40px}
    button{margin:8px 0;padding:8px}
    pre{background:#f4f4f4;padding:12px;overflow:auto}
  </style>
</head>
<body>
  <h2>Profil</h2>
  <p>
    <button id="btnMe">Meine Daten laden (/api/me)</button>
    <button id="btnAccounts">Konten laden (/api/accounts)</button>
    <button id="btnLogout">Logout</button>
  </p>
  <pre id="out">Noch nichts geladen…</pre>
  <p><a href="./index.html">Zurück</a></p>

  <script src="/js/api.js"></script>
  <script>
    const out = document.getElementById('out');
    const show = (data) => out.textContent = JSON.stringify(data, null, 2);

    // Buttons
    document.getElementById('btnMe').onclick = async () => {
      try { show(await apiFetch('/me', { method: 'GET' })); }
      catch (e) { show({error: e.message, status: e.status}); }
    };

    document.getElementById('btnAccounts').onclick = async () => {
      try { show(await apiFetch('/accounts', { method: 'GET' })); }
      catch (e) { show({error: e.message, status: e.status}); }
    };

    document.getElementById('btnLogout').onclick = () => {
      localStorage.removeItem('token');
      location.href = './login.html';
    };

    // Warnen, falls kein Token vorhanden ist
    if (!localStorage.getItem('token')) {
      out.textContent = 'Kein Token gefunden. Bitte zuerst einloggen.';
    }
  </script>
</body>
</html>
